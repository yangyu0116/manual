<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd"><html>
<head>
<meta http-equiv=Content-Type content="text/html; charset=gb2312">
<link rel="stylesheet" href="Word2Chm.css" type="text/css">
<title> InputConnection</title>
</head>
<body>     
<div class=WordSection51 style='layout-grid:15.6pt'><br clear=all
style='page-break-before:always'>

<p class=MsoNormal align=center style='text-align:center'><a
name=InputConnection><b><span style='font-size:18.0pt'>InputConnection</span></b></a></p>
<p class=MsoNormal align=center style='text-align:center'><span
>译者署名：六必治</span></p>
<p class=MsoNormal align=center style='text-align:center'><span
>译者链接：</span><u><span style='font-size:12.0pt;
color:blue'><a target="_blank" href="http://www.cnblogs.com/zcmky/">http://www.cnblogs.com/zcmky/</a></span></u></p>
<p class=MsoNormal align=center style='text-align:center'><span
>版本：</span><span>Android 2.3 r1</span></p>
<p class=MsoNormal align=left style='text-align:left'><span>&nbsp;</span></p>
<p class=MsoNormal align=left style='text-align:left'><b><span
style='font-size:12.0pt;'>结构</span></b></p>
<p class=MsoNormal align=left style='text-align:left;text-indent:21.0pt'><span
>继承关系</span></p>
<p class=MsoNormal align=left style='margin-left:21.0pt;text-align:left;
text-indent:21.0pt'><b><i><span>public interface <span
style='color:#C00000'>InputConnection</span></span></i></b></p>
<p class=MsoNormal align=left style='margin-left:21.0pt;text-align:left'><span
lang=EN-US>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></p>
<p class=MsoNormal align=left style='margin-left:21.0pt;text-align:left;
text-indent:21.0pt'><span>android.view.inputmethod.InputConnection</span></p>
<p class=MsoNormal align=left style='margin-left:42.0pt;text-align:left'><span
lang=EN-US style='font-size:9.0pt'>&nbsp;</span></p>
<p class=MsoNormal align=left style='text-align:left;text-indent:21.0pt'><span
>子类及间接子类</span></p>
<p class=MsoNormal align=left style='margin-left:42.0pt;text-align:left'><span
>间接子类</span></p>
<p class=MsoNormal style='margin-left:42.0pt;text-indent:21.0pt'><span
lang=EN-US><a target="_blank" href="http://developer.android.com/reference/android/view/inputmethod/BaseInputConnection.html">BaseInputConnection</a>,
<a target="_blank" href="http://developer.android.com/reference/android/view/inputmethod/InputConnectionWrapper.html">InputConnectionWrapper</a>
</span></p>
<p class=MsoNormal align=left style='text-align:left'><span>&nbsp;</span></p>
<p class=MsoNormal align=left style='text-align:left'><b><span
style='font-size:12.0pt;'>类概述</span></b></p>
<p style='margin:0cm;margin-bottom:.0001pt;text-indent:21.0pt'><span
lang=EN-US style='font-size:10.5pt;font-family:"Calibri","sans-serif"'>InputConnection</span><span
style='font-size:10.5pt'>接口是接收输入的应用程序与</span><code><span
style='font-size:10.5pt;font-family:"Calibri","sans-serif"'><a target="_blank" href="http://developer.android.com/reference/android/view/inputmethod/InputMethod.html">InputMethod</a></span></code><span
style='font-size:10.5pt'>间的通讯通道。它可以完成以下功能，如读取光标周围的文本，向文本框提交文本，向应用程序提交原始按键事件。</span></p>
<p style='margin:0cm;margin-bottom:.0001pt;text-indent:21.0pt'><span
lang=EN-US>&nbsp;</span><code><span style='font-size:10.5pt;
font-family:"Calibri","sans-serif"'><a target="_blank" href="http://developer.android.com/reference/android/view/inputmethod/BaseInputConnection.html">BaseInputConnection</a></span></code><span
style='font-size:10.5pt'>的子类应实现这一接口。</span></p>
<p class=MsoNormal align=left style='margin-left:42.0pt;text-align:left'><span
lang=EN-US>&nbsp;</span></p>
<p class=MsoNormal align=left style='text-align:left'><b><span
style='font-size:12.0pt;'>常量</span></b></p>
<p class=MsoNormal align=left style='margin-left:21.0pt;text-align:left'><span
lang=EN-US style='background:#D9D9D9'>public static final int <b>GET_EXTRACTED_TEXT_MONITOR</b></span></p>
<p class=MsoNormal align=left style='margin-left:21.0pt;text-align:left'><span
>标志，用在</span><code><span style='font-size:
12.0pt'><a target="_blank" href="http://developer.android.com/reference/android/view/inputmethod/InputConnection.html#getExtractedText%28android.view.inputmethod.ExtractedTextRequest,%20int%29"><span
style='font-size:10.5pt;font-family:"Calibri","sans-serif"'>getExtractedText(ExtractedTextRequest,
int)</span></a></span></code><span >中，表示提取的文本变化时你想接收到更新。</span></p>
<p class=MsoNormal align=left style='margin-left:21.0pt;text-align:left;
text-indent:21.0pt'><span >常量值</span><span>: 1
(0x00000001)</span></p>
<p class=MsoNormal align=left style='margin-left:21.0pt;text-align:left'><span
lang=EN-US>&nbsp;</span></p>
<p class=MsoNormal align=left style='margin-left:21.0pt;text-align:left'><span
lang=EN-US style='background:#D9D9D9'>public static final int <b>GET_TEXT_WITH_STYLES</b></span></p>
<p class=MsoNormal align=left style='margin-left:21.0pt;text-align:left'><span
>标志，用在</span><code><span style='font-size:
12.0pt'><a target="_blank" href="http://developer.android.com/reference/android/view/inputmethod/InputConnection.html#getTextAfterCursor%28int,%20int%29"><span
style='font-size:10.5pt;font-family:"Calibri","sans-serif"'>getTextAfterCursor(int,
int)</span></a></span></code><span >和</span><code><span
lang=EN-US style='font-size:12.0pt'><a target="_blank" href="http://developer.android.com/reference/android/view/inputmethod/InputConnection.html#getTextBeforeCursor%28int,%20int%29"><span
style='font-size:10.5pt;font-family:"Calibri","sans-serif"'>getTextBeforeCursor(int,
int)</span></a></span></code><span >中，表明返回的文本中包含样式。不设置时，你将仅接收原始文本。设置时，你将收到复合的</span><span
lang=EN-US>CharSequence</span><span >，包括文本和样式段。</span></p>
<p class=MsoNormal align=left style='margin-left:21.0pt;text-align:left;
text-indent:21.0pt'><span >常量值</span><span>: 1
(0x00000001)</span></p>
<p class=MsoNormal align=left style='margin-left:21.0pt;text-align:left;
text-indent:21.0pt'><span>&nbsp;</span></p>
<p class=MsoNormal align=left style='text-align:left'><b><span
style='font-size:12.0pt;'>公共方法</span></b></p>
<p class=MsoNormal align=left style='margin-left:21.0pt;text-align:left'><span
lang=EN-US style='background:#D9D9D9'>public abstract boolean <b>beginBatchEdit</b>
()</span></p>
<p class=MsoNormal align=left style='margin-left:21.0pt;text-align:left'><span
>通知编辑器你将开始批量编辑操作。编辑器尽量避免向你发送状态更新，直到调用</span><code><span
lang=EN-US style='font-size:12.0pt'><a target="_blank" href="http://developer.android.com/reference/android/view/inputmethod/InputConnection.html#endBatchEdit%28%29"><span
style='font-size:10.5pt;font-family:"Calibri","sans-serif"'>endBatchEdit()</span></a></span></code><span
>为止。</span></p>
<p class=MsoNormal align=left style='margin-left:21.0pt;text-align:left'><span
lang=EN-US>&nbsp;</span></p>
<p class=MsoNormal align=left style='margin-left:21.0pt;text-align:left'><span
lang=EN-US style='background:#D9D9D9'>public abstract boolean <b>clearMetaKeyStates</b>
(int states)</span></p>
<p class=MsoNormal align=left style='margin-left:21.0pt;text-align:left'><span
>在指定的输入连接中清除指定的元键</span><span>(meta key)</span><span
>按下状态。</span></p>
<p class=MsoNormal align=left style='margin-left:21.0pt;text-align:left;
text-indent:21.0pt'><span >参数</span></p>
<p class=MsoNormal align=left style='margin-left:42.0pt;text-align:left;
text-indent:21.0pt'><span>states &nbsp;&nbsp;&nbsp; </span><span
>清除的状态，可以是</span><span>KeyEvent.getMetaState()</span><span
>中的一位或多位结果。</span></p>
<p class=MsoNormal align=left style='margin-left:21.0pt;text-align:left;
text-indent:21.0pt'><span >返回值</span></p>
<p class=MsoNormal align=left style='margin-left:21.0pt;text-align:left'><span
lang=EN-US>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span
>成功返回</span><span>true</span><span
>，当连接无效时返回</span><span>flase</span><span
>。</span></p>
<p class=MsoNormal align=left style='margin-left:21.0pt;text-align:left'><span
lang=EN-US>&nbsp;</span></p>
<p class=MsoNormal align=left style='margin-left:21.0pt;text-align:left'><span
lang=EN-US style='background:#D9D9D9'>public abstract boolean <b>commitCompletion</b>
(CompletionInfo text)</span></p>
<p class=MsoNormal align=left style='margin-left:21.0pt;text-align:left'><span
>提交用户的选择，选择先前向</span> <code><span
style='font-size:12.0pt'><a target="_blank" href="http://developer.android.com/reference/android/view/inputmethod/InputMethodSession.html#displayCompletions%28android.view.inputmethod.CompletionInfo[]%29"><span
style='font-size:10.5pt;font-family:"Calibri","sans-serif"'>InputMethodSession.displayCompletions()</span></a></span></code><span
>提交的选项中的一个。其结果就像用户从实际</span><span>UI</span><span
>中做出一样。</span></p>
<p class=MsoNormal align=left style='margin-left:21.0pt;text-align:left;
text-indent:21.0pt'><span >参数</span></p>
<p class=MsoNormal align=left style='margin-left:42.0pt;text-align:left;
text-indent:21.0pt'><span>text &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span
>提交的结果。</span></p>
<p class=MsoNormal align=left style='margin-left:21.0pt;text-align:left;
text-indent:21.0pt'><span >返回值</span></p>
<p class=MsoNormal align=left style='margin-left:21.0pt;text-align:left'><span
lang=EN-US>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span
>成功返回</span><span>true</span><span
>，当连接无效时返回</span><span>flase</span><span
>。</span></p>
<p class=MsoNormal align=left style='margin-left:21.0pt;text-align:left'><span
lang=EN-US>&nbsp;</span></p>
<p class=MsoNormal align=left style='margin-left:21.0pt;text-align:left'><span
lang=EN-US style='background:#D9D9D9'>public abstract boolean <b>commitText</b>
(CharSequence text, int newCursorPosition)</span></p>
<p class=MsoNormal align=left style='margin-left:21.0pt;text-align:left'><span
>向文本框提交文本并设置新的光标位置。之前设置的正编辑文字将自动删除。</span></p>
<p class=MsoNormal align=left style='margin-left:21.0pt;text-align:left;
text-indent:21.0pt'><span >参数</span></p>
<p class=MsoNormal align=left style='margin-left:42.0pt;text-align:left;
text-indent:21.0pt'><span>text &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span
>提交的文本。</span></p>
<p class=MsoNormal align=left style='margin-left:42.0pt;text-align:left;
text-indent:21.0pt'><span>newCursorPosition &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span
>文本范围内新的光标位置。如果大于</span><span>0</span><span
>，从提交文本末尾－</span><span>1</span><span
>处计起；</span><span>&lt;= 0</span><span
>，提交文本开始处计起。所以值为</span><span>1</span><span
>时，光标将定位于你刚刚插入文本之后。注意你不能光标定位于提交文本中，因为编辑器可以修改你提供的文本，所以不必将光标定位在哪。</span></p>
<p class=MsoNormal align=left style='margin-left:21.0pt;text-align:left;
text-indent:21.0pt'><span >返回值</span></p>
<p class=MsoNormal align=left style='margin-left:21.0pt;text-align:left'><span
lang=EN-US>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span
>成功返回</span><span>true</span><span
>，当连接无效时返回</span><span>flase</span><span
>。</span></p>
<p class=MsoNormal align=left style='margin-left:21.0pt;text-align:left'><span
lang=EN-US>&nbsp;</span></p>
<p class=MsoNormal align=left style='margin-left:21.0pt;text-align:left'><span
lang=EN-US style='background:#D9D9D9'>public abstract boolean <b>deleteSurroundingText</b>
(int leftLength, int rightLength)</span></p>
<p class=MsoNormal align=left style='margin-left:21.0pt;text-align:left'><span
>删除当前光标前的</span><span>leftLength</span><span
>个字符，并删除当前光标后的</span><span>rightLength</span><span
>个字符，不包联想输入</span><span>(composing)</span><span
>的文字。</span></p>
<p class=MsoNormal align=left style='margin-left:21.0pt;text-align:left;
text-indent:21.0pt'><span >参数</span></p>
<p class=MsoNormal align=left style='margin-left:42.0pt;text-align:left;
text-indent:21.0pt'><span>leftLength &nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span
>删除的当前光标之前字符个数。</span></p>
<p class=MsoNormal align=left style='margin-left:42.0pt;text-align:left;
text-indent:21.0pt'><span>rightLength &nbsp;&nbsp;&nbsp; </span><span
>删除的当前光标之后字符个数。</span></p>
<p class=MsoNormal align=left style='margin-left:21.0pt;text-align:left;
text-indent:21.0pt'><span >返回值</span></p>
<p class=MsoNormal align=left style='margin-left:21.0pt;text-align:left'><span
lang=EN-US>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span
>成功返回</span><span>true</span><span
>，当连接无效时返回</span><span>flase</span><span
>。</span></p>
<p class=MsoNormal align=left style='margin-left:21.0pt;text-align:left'><span
lang=EN-US>&nbsp;</span></p>
<p class=MsoNormal align=left style='text-align:left;text-indent:21.0pt'><span
lang=EN-US style='background:#D9D9D9'>public abstract boolean <b>endBatchEdit</b>
()</span></p>
<p class=MsoNormal align=left style='margin-left:21.0pt;text-align:left'><code><span
style='font-size:12.0pt'>调用</span></code><code><span
style='font-size:12.0pt'><a target="_blank" href="http://developer.android.com/reference/android/view/inputmethod/InputConnection.html#endBatchEdit%28%29"><span
style='font-size:10.5pt;font-family:"Calibri","sans-serif"'>endBatchEdit()</span></a></span></code><code><span
style='font-size:12.0pt'>方法</span></code><span >通知编辑器之前开始的批量编辑已完成。</span></p>
<p class=MsoNormal align=left style='margin-left:21.0pt;text-align:left'><span
lang=EN-US>&nbsp;</span></p>
<p class=MsoNormal align=left style='margin-left:21.0pt;text-align:left'><span
lang=EN-US style='background:#D9D9D9'>public abstract boolean <b>finishComposingText</b>
()</span></p>
<p class=MsoNormal align=left style='margin-left:21.0pt;text-align:left'><span
>强制结束文本编辑器，无论联想输入</span><span>(composing text)</span><span
>是否激活。文本保持不变，移除任何与此文本的编辑样式或其他状态。光标保持不变。</span></p>
<p class=MsoNormal align=left style='margin-left:21.0pt;text-align:left'><span
lang=EN-US>&nbsp;</span></p>
<p class=MsoNormal align=left style='margin-left:21.0pt;text-align:left'><span
lang=EN-US style='background:#D9D9D9'>public abstract int <b>getCursorCapsMode</b>
(int reqModes)</span></p>
<p class=MsoNormal align=left style='margin-left:21.0pt;text-align:left'><span
>取得当前光标位置的文本的大小写状态。参见</span><code><span
style='font-size:12.0pt'><a target="_blank" href="http://developer.android.com/reference/android/text/TextUtils.html#getCapsMode%28java.lang.CharSequence,%20int,%20int%29"><span
style='font-size:10.5pt;font-family:"Calibri","sans-serif"'>TextUtils.getCapsMode</span></a></span></code><span
lang=EN-US> </span><span >取得更多信息。此方法在输入连接</span><span
lang=EN-US>(connection)</span><span >无效（如线程冲突）或客户端等待时间过长（等待几秒返回）时可能会失败。上述情况时返回</span><span
lang=EN-US>0</span><span >。</span></p>
<p class=MsoNormal align=left style='margin-left:21.0pt;text-align:left;
text-indent:21.0pt'><span >参数</span></p>
<p class=MsoNormal align=left style='margin-left:21.0pt;text-align:left'><span
lang=EN-US>reqModes &nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span
>依据</span><code><span style='font-size:12.0pt'><a target="_blank" href="http://developer.android.com/reference/android/text/TextUtils.html#getCapsMode%28java.lang.CharSequence,%20int,%20int%29"><span
style='font-size:10.5pt;font-family:"Calibri","sans-serif"'>TextUtils.getCapsMode</span></a></span></code><code><span
style='font-size:12.0pt'>的</span></code><span >定义取得期望的状态。通过已定义的常数，你可以轻易地传递</span><code><span
lang=EN-US style='font-size:12.0pt'><a target="_blank" href="http://developer.android.com/reference/android/view/inputmethod/EditorInfo.html#inputType"><span
style='font-size:10.5pt;font-family:"Calibri","sans-serif"'>TextBoxAttribute.contentType</span></a></span></code><code><span
style='font-size:12.0pt'>到</span></code><span >当前。</span></p>
<p class=MsoNormal align=left style='margin-left:21.0pt;text-align:left;
text-indent:21.0pt'><span >返回值</span></p>
<p class=MsoNormal align=left style='margin-left:21.0pt;text-align:left'><span
lang=EN-US>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span
>返回当前有效的大小写状态。</span></p>
<p class=MsoNormal align=left style='margin-left:21.0pt;text-align:left'><span
lang=EN-US>&nbsp;</span></p>
<p class=MsoNormal align=left style='margin-left:21.0pt;text-align:left'><span
lang=EN-US style='background:#D9D9D9'>public abstract ExtractedText <b>getExtractedText</b>
(ExtractedTextRequest request, int flags)</span></p>
<p class=MsoNormal align=left style='margin-left:21.0pt;text-align:left'><span
>获取当前输入连接的编辑器中的当前文本，并监视是否有变化。函数返回当前文本，当文本变化时输入连接可选择性向输入法发送更新。</span></p>
<p class=MsoNormal align=left style='margin-left:21.0pt;text-align:left'><span
>此方法在输入联接无效时（如线程冲突）或客户端等待时间过长（等待几秒返回）时可能会失败。上述情况时返回</span><span
lang=EN-US>null</span><span >值。</span></p>
<p class=MsoNormal align=left style='margin-left:21.0pt;text-align:left;
text-indent:21.0pt'><span >参数</span></p>
<p class=MsoNormal align=left style='margin-left:42.0pt;text-align:left;
text-indent:21.0pt'><span>request &nbsp; </span><span
>描述文本如何返回</span></p>
<p class=MsoNormal align=left style='margin-left:42.0pt;text-align:left;
text-indent:21.0pt'><span>flags &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span
>控制客户端的附加选项，</span><span>0</span><span
>或</span><code><span style='font-size:12.0pt'><a target="_blank" href="http://developer.android.com/reference/android/view/inputmethod/InputConnection.html#GET_EXTRACTED_TEXT_MONITOR"><span
style='font-size:10.5pt;font-family:"Calibri","sans-serif"'>GET_EXTRACTED_TEXT_MONITOR</span></a></span></code></p>
<p class=MsoNormal align=left style='margin-left:21.0pt;text-align:left;
text-indent:21.0pt'><span >返回值</span></p>
<p class=MsoNormal align=left style='margin-left:21.0pt;text-align:left'><span
lang=EN-US>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span
>返回一个</span><span>ExtractedText</span><span
>对象描述文本视窗的状态，及所包含的提取文本。</span></p>
<p class=MsoNormal align=left style='margin-left:21.0pt;text-align:left'><span
lang=EN-US>&nbsp;</span></p>
<p class=MsoNormal align=left style='margin-left:21.0pt;text-align:left'><span
lang=EN-US style='background:#D9D9D9'>public abstract CharSequence <b>getSelectedText</b>
(int flags)</span></p>
<p class=MsoNormal align=left style='margin-left:21.0pt;text-align:left'><span
>如果有的话取得所选的文本。</span></p>
<p class=MsoNormal align=left style='margin-left:21.0pt;text-align:left'><span
>此方法在输入连接无效时（如线程冲突）或客户端等待时间过长（等待几秒返回）时可能会失败。上述情况时返回</span><span
lang=EN-US>null</span><span >值。</span></p>
<p class=MsoNormal align=left style='margin-left:21.0pt;text-align:left;
text-indent:21.0pt'><span >参数</span></p>
<p class=MsoNormal align=left style='margin-left:42.0pt;text-align:left;
text-indent:21.0pt'><span>flags &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span
>提供附加选项控制，控制文本如何返回。可为</span><span>0 </span><span
>或</span> <code><span style='font-size:12.0pt'><a target="_blank" href="http://developer.android.com/reference/android/view/inputmethod/InputConnection.html#GET_TEXT_WITH_STYLES"><span
style='font-size:10.5pt;font-family:"Calibri","sans-serif"'>GET_TEXT_WITH_STYLES</span></a></span></code></p>
<p class=MsoNormal align=left style='margin-left:21.0pt;text-align:left;
text-indent:21.0pt'><span >返回值</span></p>
<p class=MsoNormal align=left style='margin-left:21.0pt;text-align:left'><span
lang=EN-US>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span
>如果有的话返回当前选取文本，如果没有文本被选中返回</span><span>null</span><span
>。</span></p>
<p class=MsoNormal align=left style='margin-left:21.0pt;text-align:left'><span
lang=EN-US>&nbsp;</span></p>
<p class=MsoNormal align=left style='margin-left:21.0pt;text-align:left'><span
lang=EN-US style='background:#D9D9D9'>public abstract CharSequence <b>getTextAfterCursor</b>
(int n, int flags)</span></p>
<p class=MsoNormal align=left style='margin-left:21.0pt;text-align:left'><span
>取得当前光标位置后的</span><span> n </span><span
>个字符文本。</span></p>
<p class=MsoNormal align=left style='margin-left:21.0pt;text-align:left'><span
>此方法在输入连接无效时（如线程冲突）或客户端等待时间过长（等待几秒返回）时可能会失败。上述情况时返回</span><span
lang=EN-US>null</span><span >值。</span></p>
<p class=MsoNormal align=left style='margin-left:21.0pt;text-align:left;
text-indent:21.0pt'><span >参数</span></p>
<p class=MsoNormal align=left style='margin-left:42.0pt;text-align:left;
text-indent:21.0pt'><span>n &nbsp;&nbsp;&nbsp;&nbsp; </span><span
>期望的文本长度</span></p>
<p class=MsoNormal align=left style='margin-left:42.0pt;text-align:left;
text-indent:21.0pt'><span>flags &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span
>提供附加选项控制，控制文本如何返回。可为</span><span>0 </span><span
>或</span> <code><span style='font-size:12.0pt'><a target="_blank" href="http://developer.android.com/reference/android/view/inputmethod/InputConnection.html#GET_TEXT_WITH_STYLES"><span
style='font-size:10.5pt;font-family:"Calibri","sans-serif"'>GET_TEXT_WITH_STYLES</span></a></span></code></p>
<p class=MsoNormal align=left style='margin-left:21.0pt;text-align:left;
text-indent:21.0pt'><span >返回值</span></p>
<p class=MsoNormal align=left style='margin-left:21.0pt;text-align:left'><span
lang=EN-US>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span
>返回当前光标后的文本，返回的文本长度可能小于</span><span> n</span></p>
<p class=MsoNormal align=left style='margin-left:21.0pt;text-align:left'><span
lang=EN-US>&nbsp;</span></p>
<p class=MsoNormal align=left style='margin-left:21.0pt;text-align:left'><span
lang=EN-US style='background:#D9D9D9'>public abstract CharSequence <b>getTextBeforeCursor</b>
(int n, int flags)</span></p>
<p class=MsoNormal align=left style='margin-left:21.0pt;text-align:left'><span
>取得当前光标位置前的</span><span> n </span><span
>个字符文本。</span></p>
<p class=MsoNormal align=left style='margin-left:21.0pt;text-align:left'><span
>本此方法在输入连接无效（如线程冲突）或客户端等待时间过长（等待几秒返回）时可能会失败。上述情况时返回</span><span
lang=EN-US>null</span><span >值。</span></p>
<p class=MsoNormal align=left style='margin-left:21.0pt;text-align:left;
text-indent:21.0pt'><span >参数</span></p>
<p class=MsoNormal align=left style='margin-left:42.0pt;text-align:left;
text-indent:21.0pt'><span>n &nbsp;&nbsp;&nbsp;&nbsp; </span><span
>期望的文本长度</span></p>
<p class=MsoNormal align=left style='margin-left:42.0pt;text-align:left;
text-indent:21.0pt'><span>flags &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span
>提供附加选项控制，控制文本如何返回。可为</span><span>0 </span><span
>或</span> <code><span style='font-size:12.0pt'><a target="_blank" href="http://developer.android.com/reference/android/view/inputmethod/InputConnection.html#GET_TEXT_WITH_STYLES"><span
style='font-size:10.5pt;font-family:"Calibri","sans-serif"'>GET_TEXT_WITH_STYLES</span></a></span></code></p>
<p class=MsoNormal align=left style='margin-left:21.0pt;text-align:left;
text-indent:21.0pt'><span >返回值</span></p>
<p class=MsoNormal align=left style='margin-left:21.0pt;text-align:left'><span
lang=EN-US>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span
>返回当前光标前的文本，返回的文本长度可能小于</span><span> n</span></p>
<p class=MsoNormal align=left style='margin-left:21.0pt;text-align:left'><span
lang=EN-US>&nbsp;</span></p>
<p class=MsoNormal align=left style='margin-left:21.0pt;text-align:left'><span
lang=EN-US style='background:#D9D9D9'>public abstract boolean <b>performContextMenuAction</b>
(int id)</span></p>
<p class=MsoNormal align=left style='margin-left:21.0pt;text-align:left'><span
>在区域中执行调用上下文菜单动作，其</span><span>id</span><span
>可能下列之一：</span><code><span style='font-size:
12.0pt'><a target="_blank" href="http://developer.android.com/reference/android/R.id.html#selectAll"><span
style='font-size:10.5pt;font-family:"Calibri","sans-serif"'>selectAll</span></a></span></code><span
lang=EN-US>, </span><code><span style='font-size:12.0pt'><a target="_blank" href="http://developer.android.com/reference/android/R.id.html#startSelectingText"><span
style='font-size:10.5pt;font-family:"Calibri","sans-serif"'>startSelectingText</span></a></span></code><span
lang=EN-US>, </span><code><span style='font-size:12.0pt'><a target="_blank" href="http://developer.android.com/reference/android/R.id.html#stopSelectingText"><span
style='font-size:10.5pt;font-family:"Calibri","sans-serif"'>stopSelectingText</span></a></span></code><span
lang=EN-US>, </span><code><span style='font-size:12.0pt'><a target="_blank" href="http://developer.android.com/reference/android/R.id.html#cut"><span
style='font-size:10.5pt;font-family:"Calibri","sans-serif"'>cut</span></a></span></code><span
lang=EN-US>, </span><code><span style='font-size:12.0pt'><a target="_blank" href="http://developer.android.com/reference/android/R.id.html#copy"><span
style='font-size:10.5pt;font-family:"Calibri","sans-serif"'>copy</span></a></span></code><span
lang=EN-US>, </span><code><span style='font-size:12.0pt'><a target="_blank" href="http://developer.android.com/reference/android/R.id.html#paste"><span
style='font-size:10.5pt;font-family:"Calibri","sans-serif"'>paste</span></a></span></code><span
lang=EN-US>, </span><code><span style='font-size:12.0pt'><a target="_blank" href="http://developer.android.com/reference/android/R.id.html#copyUrl"><span
style='font-size:10.5pt;font-family:"Calibri","sans-serif"'>copyUrl</span></a></span></code><span
lang=EN-US>, </span><span >或</span> <code><span
lang=EN-US style='font-size:12.0pt'><a target="_blank" href="http://developer.android.com/reference/android/R.id.html#switchInputMethod"><span
style='font-size:10.5pt;font-family:"Calibri","sans-serif"'>switchInputMethod</span></a></span></code><code><span
style='font-size:12.0pt'>。</span></code></p>
<p class=MsoNormal align=left style='margin-left:21.0pt;text-align:left'><span
lang=EN-US>&nbsp;</span></p>
<p class=MsoNormal align=left style='margin-left:21.0pt;text-align:left'><span
lang=EN-US style='background:#D9D9D9'>public abstract boolean <b>performEditorAction</b>
(int editorAction)</span></p>
<p class=MsoNormal align=left style='margin-left:21.0pt;text-align:left'><span
>让编辑器执行一个它可以完成的操作。</span></p>
<p class=MsoNormal align=left style='margin-left:21.0pt;text-align:left;
text-indent:21.0pt'><span >参数</span></p>
<p class=MsoNormal align=left style='margin-left:42.0pt;text-align:left;
text-indent:21.0pt'><span>editorAction &nbsp; </span><span
>必须是动作常量</span><span>EditorInfo.editorType</span><span
>中的一个，如</span><span>EditorInfo.EDITOR_ACTION_GO</span><span
>。</span></p>
<p class=MsoNormal align=left style='margin-left:21.0pt;text-align:left;
text-indent:21.0pt'><span >返回值</span></p>
<p class=MsoNormal align=left style='margin-left:21.0pt;text-align:left'><span
lang=EN-US>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span
>成功返回</span><span>true,</span><span
>如输入连接无效返回</span><span>false</span><span
>。</span></p>
<p class=MsoNormal align=left style='margin-left:21.0pt;text-align:left'><span
lang=EN-US>&nbsp;</span></p>
<p class=MsoNormal align=left style='margin-left:21.0pt;text-align:left'><span
lang=EN-US style='background:#D9D9D9'>public abstract boolean <b>performPrivateCommand</b>
(String action, Bundle data)</span></p>
<p class=MsoNormal align=left style='margin-left:21.0pt;text-align:left'><span
lang=EN-US>API</span><span >从输入法向所连接的编辑器发送私有命令。这可用于提供仅用于特定输入法及其客户端功能的特定域（</span><span
lang=EN-US>domain-specific</span><span >）。注意，因为</span><span
lang=EN-US>InputConnection</span><span >协议是异步的，你无法取回结果或知道客户端是否懂得命令；你可能使用</span><span
lang=EN-US> EditorInfo</span><span >来确定客户端是否支持某一命令。</span></p>
<p class=MsoNormal align=left style='margin-left:21.0pt;text-align:left;
text-indent:21.0pt'><span >参数</span></p>
<p class=MsoNormal align=left style='margin-left:42.0pt;text-align:left;
text-indent:21.0pt'><span>action &nbsp;&nbsp;&nbsp;&nbsp; </span><span
>要执行的命令名称。必须是作用域名，前缀你自己的包名，这样不同的开发者就不会建立让人冲突的命令。</span></p>
<p class=MsoNormal align=left style='margin-left:42.0pt;text-align:left;
text-indent:21.0pt'><span>data &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span
>命令中的数据</span></p>
<p class=MsoNormal align=left style='margin-left:21.0pt;text-align:left;
text-indent:21.0pt'><span >返回值</span></p>
<p class=MsoNormal align=left style='margin-left:21.0pt;text-align:left'><span
lang=EN-US>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span
>当命令发送后返回</span><span>true</span><span
>（无论相关的编辑是否理解它），如输入连接无效返回</span><span>false</span><span
>。</span></p>
<p class=MsoNormal align=left style='margin-left:21.0pt;text-align:left'><span
lang=EN-US>&nbsp;</span></p>
<p class=MsoNormal align=left style='margin-left:21.0pt;text-align:left'><span
lang=EN-US style='background:#D9D9D9'>public abstract boolean <b>reportFullscreenMode</b>
(boolean enabled)</span></p>
<p class=MsoNormal align=left style='margin-left:21.0pt;text-align:left'><span
>由</span><span>IME</span><span
>调用，通知客户端将在全屏与普通模式间切换。它在</span><span>
InputMethodService</span><span >的标准实现中被调用。</span></p>
<p class=MsoNormal align=left style='margin-left:21.0pt;text-align:left'><span
lang=EN-US>&nbsp;</span></p>
<p class=MsoNormal align=left style='margin-left:21.0pt;text-align:left'><span
lang=EN-US style='background:#D9D9D9'>public abstract boolean <b>sendKeyEvent</b>
(KeyEvent event)</span></p>
<p class=MsoNormal align=left style='margin-left:21.0pt;text-align:left'><span
>向当前输入连接所附着的进程发送按键事件。事件像普通按键事件一样由当前焦点，通常是提供</span><span
lang=EN-US>InputConnection</span><span >的视图。但由于协议的异步性这一点并不总是这样，焦点可能在事件收到时发生改变。</span></p>
<p class=MsoNormal align=left style='margin-left:21.0pt;text-align:left'><span
>本方法可用于向应用程序发送按键事件。如屏幕键盘可以用这一方法模拟硬件键盘。标准键盘有三种：数字（</span><span
lang=EN-US>12</span><span >键），预测键盘（</span><span
lang=EN-US>20</span><span >键）和字母（</span><span>QWERTY</span><span
>）。你可以通过事件的设备码（</span><span>device id</span><span
>）确定键盘类型。</span></p>
<p class=MsoNormal align=left style='margin-left:21.0pt;text-align:left'><span
>在你向本</span><span>API</span><span
>发送的所有按键事件中，你可能希望设置</span><code><span
style='font-size:12.0pt'><a target="_blank" href="http://developer.android.com/reference/android/view/KeyEvent.html#FLAG_SOFT_KEYBOARD"><span
style='font-size:10.5pt;font-family:"Calibri","sans-serif"'>KeyEvent.FLAG_SOFT_KEYBOARD</span></a></span></code><span
>标志，但这一标志不可设置。</span></p>
<p class=MsoNormal align=left style='margin-left:21.0pt;text-align:left;
text-indent:21.0pt'><span >参数</span></p>
<p class=MsoNormal align=left style='margin-left:42.0pt;text-align:left;
text-indent:21.0pt'><span>event &nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span
>按键事件</span></p>
<p class=MsoNormal align=left style='margin-left:21.0pt;text-align:left;
text-indent:21.0pt'><span >返回值</span></p>
<p class=MsoNormal align=left style='margin-left:21.0pt;text-align:left'><span
lang=EN-US>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span
>成功返回</span><span>true</span><span
>，当输入连接无效返回</span><span>false</span><span
>。</span></p>
<p class=MsoNormal align=left style='margin-left:21.0pt;text-align:left'><span
lang=EN-US>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span
>参见</span></p>
<p class=MsoNormal align=left style='margin-left:21.0pt;text-align:left'><span
lang=EN-US>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><code><span
lang=EN-US style='font-size:12.0pt'><a target="_blank" href="http://developer.android.com/reference/android/view/KeyEvent.html"><span
style='font-size:10.5pt;font-family:"Calibri","sans-serif"'>KeyEvent</span></a></span></code></p>
<p class=MsoNormal align=left style='margin-left:21.0pt;text-align:left'><span
lang=EN-US>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><code><span
lang=EN-US style='font-size:12.0pt'><a target="_blank" href="http://developer.android.com/reference/android/view/KeyCharacterMap.html#NUMERIC"><span
style='font-size:10.5pt;font-family:"Calibri","sans-serif"'>NUMERIC</span></a></span></code></p>
<p class=MsoNormal align=left style='margin-left:21.0pt;text-align:left'><span
lang=EN-US>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><code><span
lang=EN-US style='font-size:12.0pt'><a target="_blank" href="http://developer.android.com/reference/android/view/KeyCharacterMap.html#PREDICTIVE"><span
style='font-size:10.5pt;font-family:"Calibri","sans-serif"'>PREDICTIVE</span></a></span></code></p>
<p class=MsoNormal align=left style='margin-left:21.0pt;text-align:left'><span
lang=EN-US>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><code><span
lang=EN-US style='font-size:12.0pt'><a target="_blank" href="http://developer.android.com/reference/android/view/KeyCharacterMap.html#ALPHA"><span
style='font-size:10.5pt;font-family:"Calibri","sans-serif"'>ALPHA</span></a></span></code></p>
<p class=MsoNormal align=left style='margin-left:21.0pt;text-align:left'><span
lang=EN-US>&nbsp;</span></p>
<p class=MsoNormal align=left style='margin-left:21.0pt;text-align:left'><span
lang=EN-US style='background:#D9D9D9'>public abstract boolean <b>setComposingRegion</b>
(int start, int end)</span></p>
<p class=MsoNormal align=left style='margin-left:21.0pt;text-align:left'><span
>将特定区域设为正在编辑文本。以前设置的正在编辑文本自动移除。文本使用默认正在编辑文本样式。</span><span
lang=EN-US>(</span><span >审核注：</span><span>”composing
text”</span><span >的翻译还需要后期用例子来推测其含义。</span><span
lang=EN-US>)</span></p>
<p class=MsoNormal align=left style='margin-left:21.0pt;text-align:left;
text-indent:21.0pt'><span >参数</span></p>
<p class=MsoNormal align=left style='margin-left:42.0pt;text-align:left;
text-indent:21.0pt'><span>start &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span
>正在编辑文本开始的位置</span></p>
<p class=MsoNormal align=left style='margin-left:42.0pt;text-align:left;
text-indent:21.0pt'><span>end &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span
>正在编辑文本结束的位置。</span></p>
<p class=MsoNormal align=left style='margin-left:21.0pt;text-align:left;
text-indent:21.0pt'><span >返回值</span></p>
<p class=MsoNormal align=left style='margin-left:21.0pt;text-align:left'><span
lang=EN-US>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span
>成功返回</span><span>true</span><span
>，当输入联接无效时返回</span><span>false</span><span
>。</span></p>
<p class=MsoNormal align=left style='margin-left:21.0pt;text-align:left'><span
lang=EN-US>&nbsp;</span></p>
<p class=MsoNormal align=left style='margin-left:21.0pt;text-align:left'><span
lang=EN-US style='background:#D9D9D9'>public abstract boolean <b>setComposingText</b>
(CharSequence text, int newCursorPosition)</span></p>
<p class=MsoNormal align=left style='margin-left:21.0pt;text-align:left'><span
>将当前的光标旁正在联想文本</span><span>(composing text)</span><span
>替代为给定文本，并设置新光标位置。以前设置的正在编辑文本自动移除。（译者注：</span></p>
<p class=MsoNormal align=left style='margin-left:21.0pt;text-align:left'><i><span
lang=EN-US style='color:#C00000'>InputConnection ic =
getCurrentInputConnection();</span></i></p>
<p class=MsoNormal align=left style='margin-left:21.0pt;text-align:left'><i><span
lang=EN-US style='color:#C00000'>ic.setComposingText(&quot;Composi&quot;, 1);</span></i></p>
<p class=MsoNormal align=left style='margin-left:21.0pt;text-align:left'><span
lang=EN-US><img border=0 width=319 height=102
src="image/image048.png"></span><span
>）</span></p>
<p class=MsoNormal align=left style='margin-left:21.0pt;text-align:left;
text-indent:21.0pt'><span >参数</span></p>
<p class=MsoNormal align=left style='margin-left:42.0pt;text-align:left;
text-indent:21.0pt'><span>text &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span
>如必要正在编辑文本有样式。如文本没有附带样式对象，正在编辑文本将应用默认样式。见如何在文本上附加样式</span><span
lang=EN-US>{#link android.text.Spanned}</span><span >。</span><span
lang=EN-US>{#link android.text.SpannableString}</span><span style='font-family:
宋体'>和</span><span>{#link android.text.SpannableStringBuilder}</span><span
>是两种界面实现方式。</span></p>
<p class=MsoNormal align=left style='margin-left:42.0pt;text-align:left;
text-indent:21.0pt'><span>newCursorPosition &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span
>文本范围内新的光标位置。如果大于</span><span>0</span><span
>，从提交文本末尾－</span><span>1</span><span
>处计起；</span><span>&lt;= 0</span><span
>，提交文本开始处计起。所以值为</span><span>1</span><span
>时，光标将定位于你刚刚插入文本之后。注意你不能光标定位于提交文本中，因为编辑器可以修改你提供的文本，所以不必将光标定位在哪。</span></p>
<p class=MsoNormal align=left style='margin-left:21.0pt;text-align:left;
text-indent:21.0pt'><span >返回值</span></p>
<p class=MsoNormal align=left style='margin-left:21.0pt;text-align:left'><span
lang=EN-US>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span
>成功返回</span><span>true</span><span
>，当输入联接无效时返回</span><span>false</span><span
>。</span></p>
<p class=MsoNormal align=left style='margin-left:21.0pt;text-align:left'><span
lang=EN-US>&nbsp;</span></p>
<p class=MsoNormal align=left style='margin-left:21.0pt;text-align:left'><span
lang=EN-US style='background:#D9D9D9'>public abstract boolean <b>setSelection</b>
(int start, int end)</span></p>
<p class=MsoNormal align=left style='margin-left:21.0pt;text-align:left'><span
>设置文本编辑器的选定文本。设置到当前光标时，开始与结束取相同值。</span></p>
<p class=MsoNormal align=left style='margin-left:21.0pt;text-align:left;
text-indent:21.0pt'><span >返回值</span></p>
<p class=MsoNormal align=left style='margin-left:21.0pt;text-align:left'><span
lang=EN-US>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span
>成功返回</span><span>true</span><span
>，当输入联接无效时返回</span><span>false</span><span
>。</span></p>
<p class=MsoNormal align=left style='text-align:left'><span>&nbsp;</span></p>
<p class=MsoNormal align=left style='text-align:left'><b><span
style='font-size:12.0pt;'>补充</span></b></p>
<p class=MsoNormal align=left style='text-align:left;text-indent:21.0pt'><span
>文章链接</span></p>
<p class=MsoNormal align=left style='margin-left:42.0pt;text-align:left'><span
lang=EN-US><a target="_blank" href="http://hi.baidu.com/vickyrocker/blog/item/6429e6187dea6d158718bf63.html">android
sdk<span ><span>中</span></span>
softkeyboard<span ><span>的自己解析</span></span>(4)</a></span></p>
<p class=MsoNormal align=left style='text-align:left'><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span
>开源项目</span></p>
<p class=MsoNormal align=left style='text-align:left'><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <a target="_blank" href="http://code.google.com/p/wifikeyboard/">wifikeyboard</a></span></p>

</div>

<span style='font-size:10.5pt;font-family:"Calibri","sans-serif"'><br
clear=all style='page-break-before:auto'>
</span>

      
</body>
</html>
